Se podría organizar bastatnte mejor y 
modificar el codigo para que sea más legible
pero ya me he cansado :)